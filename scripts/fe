#!/bin/bash
set -euo pipefail
cd "$(dirname "$0")/.."

branches=(
  ksv-01-simple
  ksv-02-fsdb
  ksv-03-disk
  ksv-04-sst
)

function main() {
  last_branch='main'

  for branch in "${branches[@]}"; do
    git switch -q "$branch"
    echo "$branch"
    eval "$*"
    echo
    # shellcheck disable=2034
    last_branch="$branch"
  done

  git switch -q main
}

main "$@"
